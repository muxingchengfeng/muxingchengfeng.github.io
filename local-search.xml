<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SegmentTree(å•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢)</title>
    <link href="/2024/08/02/SegmentTree-%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2/"/>
    <url>/2024/08/02/SegmentTree-%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="SegmentTreeï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼Œä¸å«æ‡’æ ‡è®°ï¼‰"><a href="#SegmentTreeï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼Œä¸å«æ‡’æ ‡è®°ï¼‰" class="headerlink" title="SegmentTreeï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼Œä¸å«æ‡’æ ‡è®°ï¼‰"></a>SegmentTreeï¼ˆå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼Œä¸å«æ‡’æ ‡è®°ï¼‰</h1><p>å®šä¹‰ç»“æ„ä½“ $Info$ å¹¶é‡è½½å…¶åŠ å·ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span>&gt; <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SegmentTree</span> &#123;<br>    <span class="hljs-type">int</span> n;<br>    std::vector&lt;Info&gt; info;<br><br>    <span class="hljs-built_in">SegmentTree</span>()<br>    &#123;<br>    &#125;<br><br>    <span class="hljs-built_in">SegmentTree</span>(<span class="hljs-type">int</span> n, Info _init = <span class="hljs-built_in">Info</span>())<br>    &#123;<br>        <span class="hljs-built_in">init</span>(std::<span class="hljs-built_in">vector</span>&lt;Info&gt;(n, _init));<br>    &#125;<br><br>    <span class="hljs-built_in">SegmentTree</span>(<span class="hljs-type">const</span> std::vector&lt;Info&gt; &amp;_init)<br>    &#123;<br>        <span class="hljs-built_in">init</span>(_init);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;Info&gt; &amp;_init)</span></span><br><span class="hljs-function">    </span>&#123;<br>        n = (<span class="hljs-type">int</span>)_init.<span class="hljs-built_in">size</span>();<br>        info.<span class="hljs-built_in">assign</span>((n &lt;&lt; <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>, <span class="hljs-built_in">Info</span>());<br>        std::function&lt;<span class="hljs-type">void</span>(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>, <span class="hljs-type">int</span>)&gt; build = [&amp;](<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r) &#123;<br>            <span class="hljs-keyword">if</span> (l == r) &#123;<br>                info[p] = _init[l - <span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-type">int</span> m = (l + r) / <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">build</span>(<span class="hljs-number">2</span> * p, l, m);<br>            <span class="hljs-built_in">build</span>(<span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>, r);<br>            <span class="hljs-built_in">pull</span>(p);<br>        &#125;;<br>        <span class="hljs-built_in">build</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pull</span><span class="hljs-params">(<span class="hljs-type">int</span> p)</span></span><br><span class="hljs-function">    </span>&#123;<br>        info[p] = info[<span class="hljs-number">2</span> * p] + info[<span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>];<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> x, <span class="hljs-type">const</span> Info &amp;v)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (l == r) &#123;<br>            info[p] = v;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">int</span> m = (l + r) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span> (x &lt;= m) &#123;<br>            <span class="hljs-built_in">modify</span>(<span class="hljs-number">2</span> * p, l, m, x, v);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">modify</span>(<span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>, r, x, v);<br>        &#125;<br>        <span class="hljs-built_in">pull</span>(p);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">const</span> Info &amp;v)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-built_in">modify</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, p, v);<br>    &#125;<br><br>    <span class="hljs-function">Info <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (l &gt; y || r &lt; x) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Info</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (l &gt;= x &amp;&amp; r &lt;= y) &#123;<br>            <span class="hljs-keyword">return</span> info[p];<br>        &#125;<br>        <span class="hljs-type">int</span> m = (l + r) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">query</span>(<span class="hljs-number">2</span> * p, l, m, x, y) + <span class="hljs-built_in">query</span>(<span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>, r, x, y);<br>    &#125;<br><br>    <span class="hljs-function">Info <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, l, r);<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Info</span> &#123;<br>&#125;;<br><br>Info <span class="hljs-keyword">operator</span>+(<span class="hljs-type">const</span> Info &amp;a, <span class="hljs-type">const</span> Info &amp;b)<br>&#123;<br>    Info res;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç®—æ³•å’Œæ¨¡æ¿</category>
      
      <category>æ•°æ®ç»“æ„</category>
      
      <category>çº¿æ®µæ ‘</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»å…¸5 Sum over Subsets(å­é›†å’Œé—®é¢˜)</title>
    <link href="/2024/07/27/%E7%BB%8F%E5%85%B85-Sum-over-Subsets-%E5%AD%90%E9%9B%86%E5%92%8C%E9%97%AE%E9%A2%98/"/>
    <url>/2024/07/27/%E7%BB%8F%E5%85%B85-Sum-over-Subsets-%E5%AD%90%E9%9B%86%E5%92%8C%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="Sum-over-Subsets-å­é›†å’Œé—®é¢˜-ä¸SOSDP"><a href="#Sum-over-Subsets-å­é›†å’Œé—®é¢˜-ä¸SOSDP" class="headerlink" title="Sum over Subsets(å­é›†å’Œé—®é¢˜)ä¸SOSDP"></a>Sum over Subsets(å­é›†å’Œé—®é¢˜)ä¸SOSDP</h1><p>å¯¹äºäºŒè¿›åˆ¶æ•° $ğ‘¥,ğ‘¦$ ï¼Œè‹¥ $x &amp; y&#x3D;y$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§° $ğ‘¥$ æ˜¯ $ğ‘¦$ çš„å­é›†ï¼Œ$ğ‘¦$ æ˜¯ $ğ‘¥$ çš„è¶…é›†ã€‚</p><p>å‡è®¾ç°åœ¨æœ‰ $0âˆ¼2^ğ‘›âˆ’1$ è¿™ $2^ğ‘›$ ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œæ¯ä¸ªæ•°éƒ½æœ‰ä¸€ä¸ªåˆå§‹æƒå€¼ï¼Œå¦‚ä½•ç»´æŠ¤æ¯ä¸ªäºŒè¿›åˆ¶æ•°çš„å­é›†å’Œï¼Ÿ</p><p>æš´åŠ›çš„æœ‰ $ğ‘‚(3^ğ‘›)$ å†™æ³•ã€‚</p><p>ä½¿ç”¨ $SOSPDP$ å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™ä¸º $O(n2^n)$ ã€‚</p><p>è½¬ç§»æ–¹ç¨‹ä¸ºï¼š$dp[i] &#x3D; dp[i] + dp[i\oplus(1 &lt;&lt; j)]$ ã€‚</p><p>è¿™ä¸ªæ–¹æ³•ä¸ä»…ä»…å¯ç”¨äºæ±‚å­é›†å’Œé—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è¿›è¡Œå­é›†çŠ¶æ€çš„è½¬ç§»ã€‚</p><p>ä¾‹é¢˜ï¼š<a href="https://codeforces.com/contest/1995/problem/D">https://codeforces.com/contest/1995/problem/D</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n, c, k;<br>    std::cin &gt;&gt; n &gt;&gt; c &gt;&gt; k;<br>    std::string s;<br>    std::cin &gt;&gt; s;<br><br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-number">1</span> &lt;&lt; c)</span></span>;<br>    dp[<span class="hljs-number">1</span> &lt;&lt; (s.<span class="hljs-built_in">back</span>() - <span class="hljs-string">&#x27;A&#x27;</span>)]++;<br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(c)</span></span>;<br>    <span class="hljs-type">int</span> mask = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">-1</span>; i &lt; n; i++) &#123;<br>        <span class="hljs-keyword">while</span> (j + <span class="hljs-number">1</span> &lt; n &amp;&amp; j + <span class="hljs-number">1</span> - i + <span class="hljs-number">1</span> &lt;= k) &#123;<br>            j++;<br>            <span class="hljs-keyword">if</span> (cnt[s[j] - <span class="hljs-string">&#x27;A&#x27;</span>] == <span class="hljs-number">0</span>) &#123;<br>                mask ^= (<span class="hljs-number">1</span> &lt;&lt; s[j] - <span class="hljs-string">&#x27;A&#x27;</span>);<br>            &#125;<br>            cnt[s[j] - <span class="hljs-string">&#x27;A&#x27;</span>]++;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (j - i + <span class="hljs-number">1</span> == k) &#123;<br>            dp[mask]++;<br>        &#125;<br>        cnt[s[i] - <span class="hljs-string">&#x27;A&#x27;</span>]--;<br>        <span class="hljs-keyword">if</span> (cnt[s[i] - <span class="hljs-string">&#x27;A&#x27;</span>] == <span class="hljs-number">0</span>) &#123;<br>            mask ^= (<span class="hljs-number">1</span> &lt;&lt; s[i] - <span class="hljs-string">&#x27;A&#x27;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; c; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; (<span class="hljs-number">1</span> &lt;&lt; c); j++) &#123;<br>            <span class="hljs-keyword">if</span> (j &gt;&gt; i &amp; <span class="hljs-number">1</span>) &#123;<br>                dp[j] = dp[j] + dp[j ^ (<span class="hljs-number">1</span> &lt;&lt; i)];<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-type">int</span> ans = c;<br>    mask = (<span class="hljs-number">1</span> &lt;&lt; c) - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-number">1</span> &lt;&lt; c); i++) &#123;<br>        <span class="hljs-keyword">if</span> (dp[i] == <span class="hljs-number">0</span>) &#123;<br>            ans = std::<span class="hljs-built_in">min</span>(ans, __builtin_popcount(i ^ mask));<br>        &#125;<br>    &#125;<br>    std::cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> t = <span class="hljs-number">1</span>;<br>    std::cin &gt;&gt; t;<br>    <span class="hljs-keyword">while</span> (t--)<br>        <span class="hljs-built_in">solve</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç»å…¸é¢˜å‹å’Œtrick</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»å…¸4 å€å¢</title>
    <link href="/2024/07/26/%E7%BB%8F%E5%85%B84-%E5%80%8D%E5%A2%9E/"/>
    <url>/2024/07/26/%E7%BB%8F%E5%85%B84-%E5%80%8D%E5%A2%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="å€å¢"><a href="#å€å¢" class="headerlink" title="å€å¢"></a>å€å¢</h1><p>ç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œ$n$ ä¸ªèŠ‚ç‚¹ï¼Œ$n$ æ¡è¾¹ï¼ˆæ¯ä¸ªç‚¹åªæœ‰ä¸€æ¡å‡ºè¾¹ï¼Œä¸ä¸€å®šæ— ç¯ï¼‰ï¼Œè¾¹æƒä¸º0æˆ–1ï¼Œè¯¢é—®ä»æ¯ä¸ªç‚¹å‡ºå‘ç»è¿‡è¾¹æƒä¸º $0$ çš„è¾¹çš„æ•°é‡æˆ–ä¸º $1$ çš„æ•°é‡æ°å¥½ä¸º $k$ æ—¶çš„ç»ˆç‚¹ã€‚</p><p>å¦‚ä½•æˆ‘ä»¬æš´åŠ›çš„åœ¨å›¾ä¸Šæ²¿ç€è¾¹èµ°ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šè¾¾åˆ° $O(nk)$ã€‚æ— æ³•è§£å†³é—®é¢˜ã€‚</p><p>è¿™æ—¶æˆ‘ä»¬ä½¿ç”¨å€å¢ï¼Œç”¨ $f(i, j)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªèŠ‚ç‚¹èµ° $2^j$ æ­¥ååˆ°è¾¾çš„ç‚¹ï¼Œç”¨ $g(i,j)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªèŠ‚ç‚¹èµ°äº† $2^j$ æ­¥åç»å†çš„è¾¹æƒä¸º $1$ çš„è¾¹çš„æ•°é‡ã€‚ è¿™ä¸€æ­¥é¢„å¤„ç†æ—¶é—´å¤æ‚åº¦ä¸º $O(nlogk)$ ï¼Œè¿™æ ·åœ¨å¤„ç†è¯¢é—®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(klogk)$ ã€‚æ€»æ—¶é—´å¤æ‚åº¦ $O((n + k)logk)$ ã€‚</p><p>å€å¢åœ¨å¤„ç†æ ‘ä¸Šã€å›¾ä¸Šé—®é¢˜å¾€å¾€å¯ä»¥å°†å¤æ‚åº¦ç”± $O(n)$ é™ä¸º $O(logn)$ ï¼Œå¤§å¤§ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚</p><p>ä¾‹é¢˜ï¼š2024ç‰›å®¢æš‘æœŸå¤šæ ¡ç¬¬ä¸‰æ¬¡åœºJé¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> n, a, b;<br>    std::cin &gt;&gt; n &gt;&gt; a &gt;&gt; b;<br>    std::string s;<br>    std::string ss;<br>    std::cin &gt;&gt; s;<br>    <span class="hljs-keyword">while</span> (ss.<span class="hljs-built_in">size</span>() &lt; <span class="hljs-number">2</span> * a + n) &#123;<br>        ss += s;<br>    &#125;<br>    <span class="hljs-type">int</span> m = ss.<span class="hljs-built_in">size</span>();<br><br>    std::vector&lt;std::array&lt;<span class="hljs-type">int</span>, 18&gt;&gt; <span class="hljs-built_in">f</span>(n + <span class="hljs-number">1</span>);<br>    std::vector&lt;std::array&lt;<span class="hljs-type">int</span>, 18&gt;&gt; <span class="hljs-built_in">cnt</span>(n + <span class="hljs-number">1</span>);<br>    <span class="hljs-type">int</span> cnt1 = <span class="hljs-number">0</span>, cnt0 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">-1</span>; i &lt; n; i++) &#123;<br>        <span class="hljs-keyword">while</span> (j &lt; m &amp;&amp; cnt1 &lt; a &amp;&amp; cnt0 &lt; a) &#123;<br>            j++;<br>            <span class="hljs-keyword">if</span> (ss[j] == <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>                cnt0++;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cnt1++;<br>            &#125;<br>        &#125;<br>        f[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = ((j + <span class="hljs-number">1</span>) % n) + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (cnt1 == a) &#123;<br>            cnt[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cnt[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (ss[i] == <span class="hljs-string">&#x27;0&#x27;</span>) &#123;<br>            cnt0--;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cnt1--;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt; <span class="hljs-number">18</span>; j++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            f[i][j] = f[f[i][j - <span class="hljs-number">1</span>]][j - <span class="hljs-number">1</span>];<br>            cnt[i][j] = cnt[i][j - <span class="hljs-number">1</span>] + cnt[f[i][j - <span class="hljs-number">1</span>]][j - <span class="hljs-number">1</span>];<br>        &#125;<br>    &#125;<br><br>    std::string ans;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>        <span class="hljs-type">int</span> p = i;<br>        <span class="hljs-type">int</span> cnt0 = <span class="hljs-number">0</span>, cnt1 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">17</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;<br>            <span class="hljs-type">int</span> c1 = cnt[p][j];<br>            <span class="hljs-type">int</span> c0 = (<span class="hljs-number">1</span> &lt;&lt; j) - c1;<br>            <span class="hljs-keyword">if</span> (cnt0 + c0 &lt; b &amp;&amp; cnt1 + c1 &lt; b) &#123;<br>                cnt0 += c0;<br>                cnt1 += c1;<br>                p = f[p][j];<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cnt0 + c0 &lt; b) &#123;<br>                ans += <span class="hljs-string">&#x27;1&#x27;</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cnt1 + c1 &lt; b) &#123;<br>                ans += <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    std::cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç»å…¸é¢˜å‹å’Œtrick</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»å…¸3 æ— å‘è¾¹é‡å®šå‘å¤„ç†</title>
    <link href="/2024/07/25/%E7%BB%8F%E5%85%B83-%E6%97%A0%E5%90%91%E8%BE%B9%E9%87%8D%E5%AE%9A%E5%90%91%E5%A4%84%E7%90%86/"/>
    <url>/2024/07/25/%E7%BB%8F%E5%85%B83-%E6%97%A0%E5%90%91%E8%BE%B9%E9%87%8D%E5%AE%9A%E5%90%91%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="æ— å‘å›¾è¾¹çš„é‡å®šå‘å¤„ç†"><a href="#æ— å‘å›¾è¾¹çš„é‡å®šå‘å¤„ç†" class="headerlink" title="æ— å‘å›¾è¾¹çš„é‡å®šå‘å¤„ç†"></a>æ— å‘å›¾è¾¹çš„é‡å®šå‘å¤„ç†</h1><p>ç»™å®šä¸€å¼ æ— å‘å›¾ $n$ ä¸ªèŠ‚ç‚¹å’Œ $m$ æ¡è¾¹ï¼Œqæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®å…³äºå…¶å­å›¾ï¼Œè¯¢é—®å­å›¾æ€»ç‚¹æ•°ä¸è¶…è¿‡nã€‚</p><p>å¤„ç†æ—¶æˆ‘ä»¬å°†æ•´ä¸ªå­å›¾å¤„ç†å‡ºæ¥å¾€å¾€ä¼šèŠ±è´¹ $O(nm)$ æ—¶é—´å¤æ‚åº¦ï¼Œè¿™æ˜¯æ— æ³•å¤„ç†çš„ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°†æ— å‘è¾¹é‡å®šå‘ï¼Œæ¯æ¡è¾¹ä»åº¦æ•°å°çš„èŠ‚ç‚¹æŒ‡å‘åº¦æ•°å¤§çš„èŠ‚ç‚¹ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥è¯æ˜æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåªä¼šæœ‰ $O(\sqrt{2m})$ æ¡å‡ºè¾¹ã€‚è¿™æ—¶æˆ‘ä»¬å¤„ç†å‡ºå­å›¾å°±åªéœ€è¦ $O(n\sqrt{m})$ æ—¶é—´å¤æ‚åº¦ã€‚ä»è€Œè§£å†³é—®é¢˜ã€‚</p><p>è¯æ˜ï¼šè‹¥èŠ‚ç‚¹åœ¨åŸæ— å‘å›¾ä¸Šçš„åº¦æ•°å°äºç­‰äº $\sqrt{2m}$ ï¼Œåˆ™åœ¨æ–°å›¾ä¸­çš„å‡ºåº¦ä¸€å®šå°äºç­‰äº $\sqrt{2m}$ ã€‚</p><p>è‹¥èŠ‚ç‚¹åœ¨åŸæ— å‘å›¾ä¸­çš„åº¦æ•°å¤§äº $\sqrt{2m}$ ï¼Œç”±äºä¸€å…±åªæœ‰ $m$ æ¡è¾¹ï¼Œæ‰€ä»¥æ‰€æœ‰èŠ‚ç‚¹çš„åº¦æ•°å’Œä¸º $2m$ ï¼Œé‚£ä¹ˆåº¦æ•°å¤§äº $\sqrt{2m}$ çš„èŠ‚ç‚¹æœ€å¤šåªæœ‰ $\sqrt{2m}$ ä¸ªï¼Œåˆå› ä¸ºæˆ‘ä»¬ç”±åº¦æ•°å°çš„èŠ‚ç‚¹æŒ‡å‘åº¦æ•°å¤§çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥æœ€å¤šåªæœ‰ $\sqrt{2m}$ æ¡å‡ºè¾¹</p><p>ä¾‹é¢˜ï¼š2024ç‰›å®¢æš‘æœŸå¤šæ ¡ç¬¬äºŒåœºBé¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Edge</span> &#123;<br>    <span class="hljs-type">int</span> a, b, w;<br>    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span>&lt;(<span class="hljs-type">const</span> Edge &amp;t) <span class="hljs-type">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> w &lt; t.w;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n, m, q;<br>    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;<br>    std::vector&lt;std::array&lt;<span class="hljs-type">int</span>, 3&gt;&gt; <span class="hljs-built_in">edge</span>(m + <span class="hljs-number">1</span>);<br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">d</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>        <span class="hljs-type">int</span> u, v, w;<br>        std::cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;<br>        edge[i] = &#123;u, v, w&#125;;<br>        d[u]++;<br>        d[v]++;<br>    &#125;<br>    std::vector&lt;std::vector&lt;std::pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt;&gt; <span class="hljs-built_in">adj</span>(n + <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>        <span class="hljs-type">int</span> u = edge[i][<span class="hljs-number">0</span>];<br>        <span class="hljs-type">int</span> v = edge[i][<span class="hljs-number">1</span>];<br>        <span class="hljs-type">int</span> w = edge[i][<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">if</span> (u &gt; v) &#123;<br>            std::<span class="hljs-built_in">swap</span>(u, v);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (d[u] &gt; d[v]) &#123;<br>            adj[v].<span class="hljs-built_in">push_back</span>(&#123;u, w&#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            adj[u].<span class="hljs-built_in">push_back</span>(&#123;v, w&#125;);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vis</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">p</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    std::<span class="hljs-built_in">iota</span>(p.<span class="hljs-built_in">begin</span>(), p.<span class="hljs-built_in">end</span>(), <span class="hljs-number">0</span>);<br><br>    <span class="hljs-keyword">while</span> (q--) &#123;<br>        <span class="hljs-type">int</span> k;<br>        std::cin &gt;&gt; k;<br>        <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">b</span><span class="hljs-params">(k)</span></span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i++) &#123;<br>            std::cin &gt;&gt; b[i];<br>            vis[b[i]] = <span class="hljs-number">1</span>;<br>        &#125;<br><br>        std::vector&lt;Edge&gt; e;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> u : b) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> [v, w] : adj[u]) &#123;<br>                <span class="hljs-keyword">if</span> (vis[v]) &#123;<br>                    e.<span class="hljs-built_in">push_back</span>(&#123;u, v, w&#125;);<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">auto</span> find = [&amp;](<span class="hljs-keyword">auto</span> self, <span class="hljs-type">int</span> u) -&gt; <span class="hljs-type">int</span> &#123;<br>            <span class="hljs-keyword">if</span> (p[u] != u) &#123;<br>                p[u] = <span class="hljs-built_in">self</span>(self, p[u]);<br>            &#125;<br>            <span class="hljs-keyword">return</span> p[u];<br>        &#125;;<br><br>        std::<span class="hljs-built_in">sort</span>(e.<span class="hljs-built_in">begin</span>(), e.<span class="hljs-built_in">end</span>());<br>        i64 res = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> cnt = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> [u, v, w] : e) &#123;<br>            <span class="hljs-type">int</span> fu = <span class="hljs-built_in">find</span>(find, u), fv = <span class="hljs-built_in">find</span>(find, v);<br>            <span class="hljs-keyword">if</span> (fu != fv) &#123;<br>                p[fu] = fv;<br>                res += w;<br>                cnt++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (cnt == k) &#123;<br>            std::cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;-1\n&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> u : b) &#123;<br>            vis[u] = <span class="hljs-number">0</span>;<br>            p[u] = u;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> t = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// std::cin &gt;&gt; t;</span><br>    <span class="hljs-keyword">while</span> (t--)<br>        <span class="hljs-built_in">solve</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç»å…¸é¢˜å‹å’Œtrick</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»å…¸2 subset-sumé—®é¢˜</title>
    <link href="/2024/07/24/%E7%BB%8F%E5%85%B82/"/>
    <url>/2024/07/24/%E7%BB%8F%E5%85%B82/</url>
    
    <content type="html"><![CDATA[<h1 id="subset-sumé—®é¢˜"><a href="#subset-sumé—®é¢˜" class="headerlink" title="subset-sumé—®é¢˜"></a>subset-sumé—®é¢˜</h1><p>ç»™å®š $m$ å †çŸ³å¤´ï¼Œæ¯å † $a_i$ ä¸ªçŸ³å¤´ï¼Œä¸€å…±nä¸ªçŸ³å¤´ã€‚æ˜¯å¦å¯ä»¥ä»ä¸­é€‰å‡ºéƒ¨åˆ†å †å…¶æ€»å’Œä¸ºkä¸ªã€‚</p><p>ä½¿ç”¨ $dp$ æ–¹æ³•è§£å†³ï¼Œ$dp[i][j]$ è¡¨ç¤ºåœ¨å‰ $i$ ä¸ªçŸ³å¤´ä¸­é€‰æ˜¯å¦å¯ä»¥é€‰å‡ºæ€»æ•°ä¸º $j$ ç»“æœã€‚è½¬ç§»æ–¹ç¨‹ $dp[i][j] &#x3D; dp[i - 1][j] | dp[i - 1][j - a_i]$ ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2)$ ã€‚</p><p>å½“ $n$ è¿‡å¤§æ—¶ ï¼Œä¸Šè¿°æ–¹æ³•æ— æ³•è§£å†³ã€‚æ³¨æ„åˆ°çŸ³å¤´æ€»å’Œä¸º $n$ ä¸ªï¼Œé‚£ä¹ˆä½¿ç”¨äºŒè¿›åˆ¶ä¼˜åŒ–ï¼Œå¦‚æœæœ‰ä¸‰å †æ•°é‡ç›¸åŒï¼Œå¯ä»¥åˆå¹¶å…¶ä¸­ä¸¤å †ï¼Œå †çš„æ•°é‡ $m$ ä¼šé™åˆ° $\sqrt{n}$ï¼Œæ—¶é—´å¤æ‚åº¦é™ä¸º $O(n\sqrt{n})$</p><p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ $bitset$ ä¼˜åŒ– $dp$ è¿‡ç¨‹ã€‚</p><p>ä¾‹é¢˜ï¼š<a href="https://codeforces.com/problemset/problem/1381/B">https://codeforces.com/problemset/problem/1381/B</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n;<br>    std::cin &gt;&gt; n;<br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * <span class="hljs-number">2</span>; i++) &#123;<br>        std::cin &gt;&gt; a[i];<br>    &#125;<br><br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">2</span> * n + <span class="hljs-number">2</span>)</span></span>;<br>    v[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> mx = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * <span class="hljs-number">2</span>; i++) &#123;<br>        mx = std::<span class="hljs-built_in">max</span>(mx, a[i]);<br>        <span class="hljs-keyword">if</span> (mx == a[i]) &#123;<br>            v[i - <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dp</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * <span class="hljs-number">2</span>; i++) &#123;<br>        <span class="hljs-keyword">auto</span> ndp = dp;<br>        <span class="hljs-type">int</span> len = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span> (v[i] == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;<br>                <span class="hljs-keyword">if</span> (v[j]) &#123;<br>                    len = i - j;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = len; j &lt;= n; j++) &#123;<br>            <span class="hljs-keyword">if</span> (dp[j - len] == <span class="hljs-number">1</span>) &#123;<br>                ndp[j] = <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>        std::<span class="hljs-built_in">swap</span>(dp, ndp);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (dp[n]) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;YES\n&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;NO\n&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> t = <span class="hljs-number">1</span>;<br>    std::cin &gt;&gt; t;<br>    <span class="hljs-keyword">while</span> (t--)<br>        <span class="hljs-built_in">solve</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç»å…¸é¢˜å‹å’Œtrick</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»å…¸1</title>
    <link href="/2024/07/23/%E7%BB%8F%E5%85%B81/"/>
    <url>/2024/07/23/%E7%BB%8F%E5%85%B81/</url>
    
    <content type="html"><![CDATA[<p>ç»™å®š $n$ å †ä¸œè¥¿ï¼Œæ¯å †æœ‰ $a_i$ ä¸ªä¸”ç§ç±»ä¸åŒã€‚è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><p>æ¯æ¬¡ä» $n$ å †ä¸œè¥¿ä¸­é€‰å‡º $k$ å †ï¼Œæ¯å †å–èµ°ä¸€ä¸ªã€‚</p><p>è¯¢é—®æœ€å¤šèƒ½è¿›è¡Œå¤šå°‘æ¬¡æ“ä½œã€‚</p><p>ç»“è®ºï¼šè®¾ $x$ ä¸ºæ“ä½œæ¬¡æ•°ï¼Œåˆ™ $\sum_{i&#x3D;1}^nmin(a_i, x) \geq kx$ ä¸º $x$ åˆæ³•çš„å……åˆ†å¿…è¦æ¡ä»¶ã€‚</p><p>å¿…è¦æ€§æ˜¾ç„¶ï¼Œä¸‹è¯å……åˆ†æ€§ã€‚</p><p>æ¯æ¬¡å°†ä¸œè¥¿æœ€å¤šçš„ $k$ ä¸ªå †å–å‡ºä¸€ä¸ªã€‚è´ªå¿ƒæˆç«‹æ€§çš„åŸå› åœ¨äºæ¯æ¬¡ç›¸å½“äºæ¯æ¬¡å°† $a_1, a_2, . . . , a_n$ä¸­æœ€å¤§çš„ $k$ ä¸ªå…ƒç´ å‡ä¸€ï¼Œæ›´æ–°åçš„æ•°ç»„ $a_i^{â€˜}$ æ»¡è¶³ $âˆ‘^n_{ i&#x3D;1} min(a ^â€²_i , x âˆ’ 1) â‰¥ (x âˆ’ 1)k$ã€‚ç”±æ•°å­¦å½’çº³æ³•å¯çŸ¥æ­£ç¡®æ€§ã€‚</p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥çŸ¥é“å½“å¯ä»¥å– $x$ æ¬¡ä¸€å®šå¯ä»¥å– $x - 1$ æ¬¡ï¼Œåˆ™è¯´æ˜ç­”æ¡ˆå…·æœ‰äºŒæ®µæ€§ï¼Œå¯ä»¥äºŒåˆ†ç­”æ¡ˆæ‰¾å‡ºå…¶ä¸­çš„å¯æ“ä½œæ¬¡æ•°çš„æœ€å¤§å€¼ã€‚</p><p>ä¾‹é¢˜ï¼š2024ç‰›å®¢æš‘æœŸå¤šæ ¡ç¬¬ä¸‰åœºAé¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> n, L, R;<br>    std::cin &gt;&gt; n &gt;&gt; L &gt;&gt; R;<br>    <span class="hljs-function">std::vector&lt;i64&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>        std::cin &gt;&gt; a[i];<br>        a[i] = (a[i] - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br>    &#125;<br><br>    i64 cnt = (n - R + (R - L - <span class="hljs-number">1</span>)) / (R - L);<br>    i64 l = <span class="hljs-number">0</span>, r = <span class="hljs-number">1E9</span>;<br>    <span class="hljs-keyword">while</span> (l &lt; r) &#123;<br>        i64 mid = l + r + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>;<br>        i64 sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            sum += std::<span class="hljs-built_in">min</span>(a[i], mid);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (sum &gt;= mid * L) &#123;<br>            l = mid;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            r = mid - <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (l &gt;= cnt) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Yes\n&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;No\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç«èµ›</category>
      
      <category>ç»å…¸é¢˜å‹å’Œtrick</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç‰›å®¢ 2024æš‘æœŸå¤šæ ¡ç¬¬ä¸‰åœºé¢˜è§£</title>
    <link href="/2024/07/23/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E7%AC%AC%E4%B8%89%E5%9C%BA%E9%A2%98%E8%A7%A3/"/>
    <url>/2024/07/23/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E7%AC%AC%E4%B8%89%E5%9C%BA%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç‰›å®¢ 2024æš‘æœŸå¤šæ ¡ç¬¬ä¸€åœºé¢˜è§£</title>
    <link href="/2024/07/16/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E7%AC%AC%E4%B8%80%E5%9C%BA%E9%A2%98%E8%A7%A3/"/>
    <url>/2024/07/16/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E7%AC%AC%E4%B8%80%E5%9C%BA%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="A-A-Bit-Common"><a href="#A-A-Bit-Common" class="headerlink" title="A A Bit Common"></a>A A Bit Common</h1><p>æˆ‘ä»¬å°†æ•°å­—é›†åˆåˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œä¸€ä¸ªé›†åˆå†…ä¸ºæœ€ä½ä½ä¸º0ï¼Œè®°ä¸º $S_0$ã€‚å¦ä¸€ä¸ªé›†åˆå†…ä¸ºæœ€ä½ä½ä¸º1ï¼Œè®°ä¸º$S_1$ã€‚</p><p>æˆ‘ä»¬åˆ’åˆ† $k$ ä¸ªæ•°åœ¨é›†åˆ $S_1$ ä¸­ï¼Œåˆ™é›†åˆ $S_0$ ä¸­æœ‰ $n - k$ ä¸ªæ•°ã€‚ç”±äºæœ€ç»ˆå­åºåˆ— $AND$ åœ¨ä¸€èµ·ä¸º1ï¼Œæ‰€æœ‰é›†åˆ $S_0$ ä¸­çš„æ•°ä¸€å®šä¸åœ¨å­åºåˆ—ä¸­ã€‚</p><p>è€ƒè™‘é›†åˆ $S_0$ ä¸­é™¤äº†æœ€ä½ä½å¿…é¡»ä¸º0ï¼Œæ²¡æœ‰å…¶ä»–é™åˆ¶ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°æœ‰ $2^{m - 1}$ ç§æ–¹æ¡ˆï¼Œä¸€å…± $(2^{m - 1})^{n - k}$ ç§ã€‚</p><p>å­åºåˆ—ä¸€å®šæ˜¯é›†åˆ $S_1$ çš„å­é›†ï¼Œç”±äº $AND$ çš„æ€§è´¨ï¼Œå°†é›†åˆ $S_1$ ä¸­ä¸åœ¨å­åºåˆ—ä¸­çš„æ•°åŠ å…¥å­åºåˆ—ï¼Œç»“æœä¾ç„¶ä¸º1ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥å°†å­åºåˆ—è®¤å®šä¸ºé›†åˆ $S_1$ ã€‚å³åªè¦æ‰€æœ‰äºŒè¿›åˆ¶æœ€ä½ä½ä¸º 1 çš„æ•° $AND$ å’Œæ˜¯ 1 å°±èƒ½æ»¡è¶³æ¡ä»¶ã€‚</p><p>é›†åˆ $S_1$ è¿™äº›æ•°é™¤äº†æœ€ä½ä½çš„ AND å’Œ éƒ½è¦æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä½ä¸Šè¿™äº›æ•°éƒ½è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯ 0ã€‚è€ƒè™‘ä½¿å¾—ä¸€ä½ $AND$ ä¸º0ï¼Œæœ‰ $2^k-1$ ç§æ–¹æ¡ˆï¼Œä¸€å…± $m - 1$ ä½ï¼Œæ‰€ä»¥é›†åˆ $S_1$ å…± $(2^k - 1) ^ {m - 1}$ ç§æ–¹æ¡ˆã€‚</p><p>æœ€åè€ƒè™‘åˆ°ä» $n$ ä¸ªæ•°ä¸­é€‰å‡º $k$ ä¸ªåœ¨é›†åˆ $S_1$ ä¸­ï¼Œå³ $C_n^k$ ç§æ–¹æ¡ˆã€‚</p><p>æœ€ç»ˆæ–¹æ¡ˆæ•°æ˜¯ $C_n^k(2^{m-1})^{n-k}(2^k-1)^{m-1}$ ï¼Œå¯¹ k ä» 1 åˆ° n æ±‚å’Œå³å¯ã€‚</p><p>ç”±äºæ¨¡æ•°ä¸ä¸€å®šäº’è´¨ï¼Œä½¿ç”¨é€’æ¨æ³•æ±‚ç»„åˆæ•°ã€‚æ—¶é—´å¤æ‚åº¦ $O(n^2)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> k, <span class="hljs-type">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (k) &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>)<br>            res = (i64)res * a % p;<br>        a = (i64)a * a % p;<br>        k = k &gt;&gt; <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n, m, mod;<br>    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; mod;<br><br>    std::vector&lt;std::vector&lt;i64&gt;&gt; <span class="hljs-built_in">c</span>(n + <span class="hljs-number">1</span>, std::<span class="hljs-built_in">vector</span>&lt;i64&gt;(n + <span class="hljs-number">1</span>));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;<br>            <span class="hljs-keyword">if</span> (!j) &#123;<br>                c[i][j] = <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                c[i][j] = (c[i - <span class="hljs-number">1</span>][j] + c[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]) % mod;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    i64 ans = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> m2 = <span class="hljs-built_in">qmi</span>(<span class="hljs-number">2</span>, m - <span class="hljs-number">1</span>, mod);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>        ans = (ans + (c[n][i] * <span class="hljs-built_in">qmi</span>(m2, n - i, mod) % mod) * <span class="hljs-built_in">qmi</span>(<span class="hljs-built_in">qmi</span>(<span class="hljs-number">2</span>, i, mod) - <span class="hljs-number">1</span>, m - <span class="hljs-number">1</span>, mod) % mod) % mod;<br>    &#125;<br>    std::cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> t = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// std::cin &gt;&gt; t;</span><br>    <span class="hljs-keyword">while</span> (t--)<br>        <span class="hljs-built_in">solve</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="B-A-Bit-More-Common"><a href="#B-A-Bit-More-Common" class="headerlink" title="B A Bit More Common"></a>B A Bit More Common</h1><p>åŒé¢˜ A å°†æ•°å­—é›†åˆåˆ†ä¸ºä¸¤ä¸ªé›†åˆ $S_0$ å’Œ $S_1$ ï¼Œæˆ‘ä»¬åˆ’åˆ† $k$ ä¸ªæ•°åœ¨é›†åˆ $S_1$ ä¸­ï¼Œåˆ™é›†åˆ $S_0$ ä¸­æœ‰ $n - k$ ä¸ªæ•°ã€‚ç”±äºæœ€ç»ˆä¸¤ä¸ªå­åºåˆ— $AND$ åœ¨ä¸€èµ·åˆ†åˆ«ä¸º1ï¼Œæ‰€æœ‰é›†åˆ $S_0$ ä¸­çš„æ•°ä¸€å®šä¸åœ¨ä»»æ„ä¸€ä¸ªå­åºåˆ—ä¸­ã€‚</p><p>è€ƒè™‘é›†åˆ $S_0$ ä¸­é™¤äº†æœ€ä½ä½å¿…é¡»ä¸º0ï¼Œæ²¡æœ‰å…¶ä»–é™åˆ¶ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°æœ‰ $2^{m - 1}$ ç§æ–¹æ¡ˆï¼Œä¸€å…± $(2^{m - 1})^{n - k}$ ç§ã€‚</p><p>ä¸€ä¸ªå­åºåˆ—ä¸€å®šæ˜¯é›†åˆ $S_1$ çš„çœŸå­é›†ï¼ˆä¸¤ä¸ªå­åºåˆ—ä¸å¯èƒ½åŒæ—¶ä¸º $S_1$ï¼‰ï¼Œç”±äº $AND$ çš„æ€§è´¨ï¼Œå°†é›†åˆ $S_1$ ä¸­ä¸åœ¨å­åºåˆ—ä¸­çš„æ•°åŠ å…¥å­åºåˆ—ï¼Œç»“æœä¾ç„¶ä¸º1ï¼Œè¿™æ ·å°±å¯ä»¥ç»„æˆå¦ä¸€ä¸ªå­åºåˆ—ã€‚æ‰€ä»¥ B é¢˜å¯ä»¥è½¬åŒ–ä¸ºæ±‚é›†åˆ $S_1$ ä¸­å­˜åœ¨çœŸå­é›† $AND$ ç»“æœä¸º1çš„æ–¹æ¡ˆæ•°ã€‚</p><p>è€ƒè™‘ A é¢˜ä¸­å·²ç»å¾—åˆ°é›†åˆ $S_1$ ä¸­å­˜åœ¨å­é›† $AND$ ç»“æœä¸º1çš„æ–¹æ¡ˆæ•°ï¼Œä¸º$(2^k - 1) ^ {m - 1}$ ç§ï¼Œå‡å»æ–¹æ¡ˆä¸­åˆæ³•å­é›†ä¸€å®šä¸ºé›†åˆ $S_1$ æœ¬èº«çš„æ–¹æ¡ˆæ•°å³å¯ã€‚</p><p>è¦è®©é›†åˆ $S_1$ ä¸­æ¯ä¸ªçš„é›†åˆæˆå‘˜éƒ½ä¸€å®šè¦åœ¨å­åºåˆ—ä¸­ï¼Œåˆ™åœ¨ $m-1$ ä½ä¸­ä¸€å®šæœ‰å‡ ä½åªæœ‰åœ¨è¿™ä¸ªæ•°çš„ä½ç½®ä¸Šä¸º0ï¼Œè€Œå…¶ä½™ $k-1$ ä¸ªé›†åˆæˆå‘˜åœ¨è¿™ä¸€ä½ä¸º1ã€‚</p><p>æˆ‘ä»¬æ¯æ¬¡ä» $m-1$  ä½ä¸­é€‰å‡º $j$ ä½ï¼Œè¡¨ç¤ºè¿™ $j$ ä½åªåœ¨ $k$ ä¸ªæ•°ä¸­æŸä¸€ä½ä¸º0ï¼Œå…¶ä½™ä¸º1ï¼Œä¸” $k$ ä¸ªæ•°è‡³å°‘åˆ†åˆ° $j$ ä¸ªä¸­çš„ä¸€ä½ã€‚è¿™å°±æ˜¯å°†ä¸åŒçš„å°çƒæ”¾åœ¨ä¸åŒçš„ç›’å­ä¸­ï¼Œä¸”ç›’å­ä¸èƒ½ä¸ºç©ºï¼Œç­”æ¡ˆä¸º $S[j][k] * k!$ ï¼Œå…¶ä¸­ $S$ è¡¨ç¤ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ã€‚å‰©ä¸‹çš„ $m - 1 - j$ ä½åªè¦ä¿è¯ $k$ ä¸ªæ•°ä¸­å­˜åœ¨è‡³å°‘ä¸¤ä¸ªæ•°è¿™ä¸€ä½ä½ä¸º0å³å¯ï¼Œå³ä¸º $(2^k-1-k)^{m-1-j}$ ç§æ–¹æ¡ˆã€‚</p><p>æ‰€æœ‰ä¸æ»¡è¶³æ¡ä»¶çš„æ€»æ–¹æ¡ˆæ•°ä¸º $\sum_k^{m-1} C_{m-1}^jS[j][k]*k!(2^k-1-k)^{m-1-j}$ ï¼Œå‡å»è¿™éƒ¨åˆ†å¾—åˆ° $S_1$ é›†åˆçš„åˆæ³•æ–¹æ¡ˆæ•°ï¼Œå³$$(2^k - 1) ^ {m - 1} - \sum_k^{m-1} C_{m-1}^jS[j][k]*k!(2^k-1-k)^{m-1-j} (k \le j\le m-1)$$</p><p>å°† $k$ ä»2å¾ªç¯åˆ°næ±‚å’Œå³å¯ï¼Œå¾—åˆ°</p><p>$$\sum_2^n (C_n^k(2^{m - 1})^{n - k} * ((2^k - 1) ^ {m - 1} - \sum_k^{m-1} (C_{m-1}^jS[j][k]*k!(2^k-1-k)^{m-1-j})))$$</p><p>é¢„å¤„ç†å‡ºç»„åˆæ•°ï¼Œæ–¯ç‰¹æ—æ•°ï¼Œä»¥åŠå¯¹åº”çš„2çš„å¹‚æ¬¡ï¼Œæ³¨æ„å–æ¨¡ï¼Œæ—¶é—´å¤æ‚åº¦ $O(nm)$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> i64 = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> k, <span class="hljs-type">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (k) &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>)<br>            res = (i64)res * a % p;<br>        a = (i64)a * a % p;<br>        k = k &gt;&gt; <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5001</span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n, m, mod;<br>    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; mod;<br><br>    std::vector&lt;std::vector&lt;i64&gt;&gt; <span class="hljs-built_in">c</span>(N, std::<span class="hljs-built_in">vector</span>&lt;i64&gt;(N));<br>    std::vector&lt;std::vector&lt;i64&gt;&gt; <span class="hljs-built_in">S</span>(N, std::<span class="hljs-built_in">vector</span>&lt;i64&gt;(N));<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;<br>            <span class="hljs-keyword">if</span> (!j) &#123;<br>                c[i][j] = <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                c[i][j] = (c[i - <span class="hljs-number">1</span>][j] + c[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]) % mod;<br>            &#125;<br>        &#125;<br>    &#125;<br>    S[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; N; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt; N; j++) &#123;<br>            S[i][j] = (S[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + j * S[i - <span class="hljs-number">1</span>][j]) % mod;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function">std::vector&lt;i64&gt; <span class="hljs-title">A</span><span class="hljs-params">(N)</span>, <span class="hljs-title">B</span><span class="hljs-params">(N)</span></span>;<br>    A[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; N; i++) &#123;<br>        A[i] = A[i - <span class="hljs-number">1</span>] * i % mod;<br>    &#125;<br><br>    B[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; N; i++) &#123;<br>        B[i] = B[i - <span class="hljs-number">1</span>] * <span class="hljs-number">2</span> % mod;<br>    &#125;<br><br>    i64 ans = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<br>        i64 a = <span class="hljs-built_in">qmi</span>(((B[i] - <span class="hljs-number">1</span>) % mod + mod) % mod, m - <span class="hljs-number">1</span>, mod);<br>        i64 d = <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> cur = ((B[i] - <span class="hljs-number">1</span> - i) % mod + mod) % mod;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = m - <span class="hljs-number">1</span>; j &gt;= i; j--) &#123;<br>            <span class="hljs-keyword">if</span> (m - <span class="hljs-number">1</span> - j &gt; <span class="hljs-number">0</span>) &#123;<br>                d = d * cur % mod;<br>            &#125;<br>            i64 b = ((c[m - <span class="hljs-number">1</span>][j] * S[j][i] % mod) * A[i] % mod) * d % mod;<br>            a = ((a - b) % mod + mod) % mod;<br>        &#125;<br>        i64 res = ((i64)c[n][i] * <span class="hljs-built_in">qmi</span>(B[m - <span class="hljs-number">1</span>], n - i, mod) % mod) * a % mod;<br>        ans = (ans + res) % mod;<br>    &#125;<br>    std::cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    std::cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);<br><br>    <span class="hljs-type">int</span> t = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// std::cin &gt;&gt; t;</span><br>    <span class="hljs-keyword">while</span> (t--)<br>        <span class="hljs-built_in">solve</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç‰›å®¢</category>
      
      <category>2024æš‘æœŸå¤šæ ¡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç‰›å®¢ 2024æš‘æœŸå¤šæ ¡é¢˜è§£</title>
    <link href="/2024/07/07/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E9%A2%98%E8%A7%A3/"/>
    <url>/2024/07/07/%E7%89%9B%E5%AE%A2-2024%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹ç‰›å®¢ 2024 æš‘æœŸå¤šæ ¡é¢˜è§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç‰›å®¢</category>
      
      <category>2024æš‘æœŸå¤šæ ¡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æµ‹è¯•æ–‡ç« </title>
    <link href="/2024/07/05/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/"/>
    <url>/2024/07/05/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/07/05/hello-world/"/>
    <url>/2024/07/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
